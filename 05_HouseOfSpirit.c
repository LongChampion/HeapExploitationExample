#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <string.h>

typedef long long LONG;
const LONG SIZE = 0x30;

struct Chunk
{
	LONG pre_size, size;
	struct Chunk *fd, *bk;
	char buf[0x20];
};

int main()
{
	struct Chunk Fake[2];
	void *temp = malloc(SIZE);

	Fake[0].size = sizeof(struct Chunk);
	Fake[1].pre_size = sizeof(struct Chunk);
	Fake[1].size = sizeof(struct Chunk);

	temp = (void *)&Fake[0].fd;
	free(temp);

	temp = malloc(SIZE);
	memcpy((char *)&Fake[0].fd, "Hacked!\n", 8);
	write(1, temp, 8);
}

